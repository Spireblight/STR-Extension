let token,userId,channelId,login;const twitch=window.Twitch.ext,BACKEND_URL="https://slaytherelics.xyz:8080",MSG_TYPE_SET_RELICS=1,MSG_TYPE_ADD_STREAMER=2,MSG_TYPE_STREAMER_EXISTS=3,RESPONSE_SUCCESS="Success",RESPONSE_TRUE="true",RESPONSE_FALSE="false",TEXT_STREAMER_EXISTS="Streamer with this login already exists in this extension. Saving a new secret will overwrite the existing secret.",TEXT_STREAMER_NOT_EXISTS="This login is not yet registered with this extension. Click Generate and copy the secret into the slaytherelics_config.txt file then click 'Save Secret'",TEXT_STREAMER_ADD_SUCCESS="Streamer secret succesfully saved!",TEXT_STREAMER_ADD_FAILURE="Something went wrong, send this message to the developer (adam@slaytherelics.xyz).",COLOR_STREAMER_EXISTS="green",COLOR_STREAMER_NOT_EXISTS="black",COLOR_STREAMER_ADD_SUCCESS="green",COLOR_STREAMER_ADD_FAILURE="red";twitch.onContext(a=>{twitch.rig.log(a)}),twitch.onAuthorized(a=>{token=a.token,userId=a.userId,channelId=a.channelId,setStatus("Ready","black")});function generateRandomSecret(){var a=randomStr(20);document.getElementById("text_streamer_secret").setAttribute("value",a),document.getElementById("config_file").innerHTML="login:&lt;put_your_twitch_login_here_without_the_brackets&gt;<br>secret:"+a}function randomStr(a){for(var b="0123456789abcdefghijklmnopqrstuvwxyz",c="",d=a;0<d;d--)c+=b[Math.floor(Math.random()*b.length)];return c}function setStatus(a,b){document.getElementById("backend_status").innerHTML="<span style=\"color: "+b+"\">"+a+"</span>"}function getResponseString(a){return"status: "+a.status+" type: "+a.responseType+" text: "+a.responseText}function saveSecret(){setStatus("saving secret","black");var a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState?201==this.status?setStatus(TEXT_STREAMER_ADD_SUCCESS,COLOR_STREAMER_ADD_SUCCESS):setStatus(TEXT_STREAMER_ADD_FAILURE+" "+getResponseString(this),COLOR_STREAMER_ADD_FAILURE):setStatus(getResponseString(this),"black")},a.open("post",BACKEND_URL),a.setRequestHeader("Content-Type","application/json");var b=document.getElementById("text_streamer_secret").getAttribute("value"),c={msg_type:MSG_TYPE_ADD_STREAMER,streamer:{login:login,secret:b,channel_id:channelId}};a.send(JSON.stringify(c))}$(function(){document.getElementById("btn_generate").onclick=generateRandomSecret,document.getElementById("btn_save").onclick=saveSecret});